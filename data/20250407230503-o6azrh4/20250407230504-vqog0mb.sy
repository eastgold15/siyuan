{"ID":"20250407230504-vqog0mb","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250407230504-vqog0mb","title":"在 Nuxt 3 中，处理不同环境(开发生产)的 base URL 和配置的最佳实践如下：","type":"doc","updated":"20250510111017"},"Children":[{"ID":"20250510111017-gdcip1w","Type":"NodeThematicBreak","Properties":{"id":"20250510111017-gdcip1w","updated":"20250510111017"}},{"ID":"20250510111017-i18xqls","Type":"NodeParagraph","Properties":{"id":"20250510111017-i18xqls","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"title: 在 Nuxt 3 中，处理不同环境(开发生产)的 base URL 和配置的最佳实践如下：\ndate: 2025-04-07T23:05:04Z\nlastmod: 2025-05-10T10:48:11Z"}]},{"ID":"20250510111017-ykco5wt","Type":"NodeThematicBreak","Properties":{"id":"20250510111017-ykco5wt","updated":"20250510111017"}},{"ID":"20250510111017-56i87ex","Type":"NodeThematicBreak","Properties":{"id":"20250510111017-56i87ex","updated":"20250510111017"}},{"ID":"20250510111017-tsct2ik","Type":"NodeParagraph","Properties":{"id":"20250510111017-tsct2ik","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"title: 在 Nuxt 3 中，处理不同环境(开发生产)的 base URL 和配置的最佳实践如下："},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"date: 2025-04-07T23:05:04Z"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"lastmod: 2025-04-07T23:20:00Z"}]},{"ID":"20250510111017-ou5i2c2","Type":"NodeThematicBreak","Properties":{"id":"20250510111017-ou5i2c2","updated":"20250510111017"}},{"ID":"20250510111017-befy3kf","Type":"NodeParagraph","Properties":{"id":"20250510111017-befy3kf","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"‍"}]},{"ID":"20250510111017-0erbr3m","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250510111017-0erbr3m","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"1. 环境变量与 runtimeConfig 最佳实践"}]},{"ID":"20250510111017-7rog15n","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111017-7rog15n","updated":"20250510111017"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dHlwZXNjcmlwdA=="},{"Type":"NodeCodeBlockCode","Data":"export default defineNuxtConfig({\n  runtimeConfig: {\n    // 仅在服务端可用的私有变量\n    apiSecret: '', // 会被.env中的NUXT_API_SECRET覆盖\n    \n    // 客户端也可用的公共变量\n    public: {\n      apiBaseUrl: process.env.NUXT_PUBLIC_API_BASE_URL || 'https://default-api.example.com'\n    }\n  }\n})\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250510111017-p2pgefj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111017-p2pgefj","updated":"20250510111017"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250510111017-1g8ma9s","Type":"NodeParagraph","Properties":{"id":"20250510111017-1g8ma9s","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"使用方式："}]},{"ID":"20250510111017-nofmwze","Type":"NodeList","ListData":{},"Properties":{"id":"20250510111017-nofmwze","updated":"20250510111017"},"Children":[{"ID":"20250510111017-hitbdzq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250510111017-hitbdzq","updated":"20250510111017"},"Children":[{"ID":"20250510111017-zdguc85","Type":"NodeParagraph","Properties":{"id":"20250510111017-zdguc85","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"创建 .env 文件："}]},{"ID":"20250510111017-8l18s46","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111017-8l18s46","updated":"20250510111017"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGxhaW50ZXh0"},{"Type":"NodeCodeBlockCode","Data":"# 开发环境\nNUXT_PUBLIC_API_BASE_URL=http://localhost:3000/api\n\n# 生产环境 (通常由CI/CD设置)\n# NUXT_PUBLIC_API_BASE_URL=https://api.example.com\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250510111017-mfaf99w","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250510111017-mfaf99w","updated":"20250510111017"},"Children":[{"ID":"20250510111017-7iq5rip","Type":"NodeParagraph","Properties":{"id":"20250510111017-7iq5rip","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"在代码中使用："}]},{"ID":"20250510111017-4p2b7qw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111017-4p2b7qw","updated":"20250510111017"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dHlwZXNjcmlwdA=="},{"Type":"NodeCodeBlockCode","Data":"const runtimeConfig = useRuntimeConfig()\nconst baseUrl = runtimeConfig.public.apiBaseUrl\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250510111017-8frcx3x","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250510111017-8frcx3x","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"2. "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"development 和"},{"Type":"NodeText","Data":"production 的意义"}]},{"ID":"20250510111017-uzxvq7v","Type":"NodeParagraph","Properties":{"id":"20250510111017-uzxvq7v","updated":"20250510111017"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"development 和"},{"Type":"NodeText","Data":"production 是 Nuxt 3 的条件配置，允许你根据环境指定不同的配置："}]},{"ID":"20250510111017-18xjgjv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111017-18xjgjv","updated":"20250510111017"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dHlwZXNjcmlwdA=="},{"Type":"NodeCodeBlockCode","Data":"export default defineNuxtConfig({\n  // 通用配置\n  \n  $production: {\n    // 仅在生产环境生效\n    routeRules: {\n      '/**': { isr: true } // 生产环境启用增量静态再生\n    },\n    nitro: {\n      compressPublicAssets: true // 生产环境启用压缩\n    }\n  },\n  \n  $development: {\n    // 仅在开发环境生效\n    devtools: { enabled: true }, // 开发工具\n    sourcemap: true, // 启用sourcemap\n    vite: {\n      server: {\n        hmr: true // 热模块替换\n      }\n    }\n  }\n})\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250510111017-4rfl2za","Type":"NodeParagraph","Properties":{"id":"20250510111017-4rfl2za","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"$development 存在的意义 ："}]},{"ID":"20250510111017-434twjp","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250510111017-434twjp","updated":"20250510111017"},"Children":[{"ID":"20250510111017-ljv3c35","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250510111017-ljv3c35","updated":"20250510111017"},"Children":[{"ID":"20250510111017-wcwi9us","Type":"NodeParagraph","Properties":{"id":"20250510111017-wcwi9us","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"开发工具 ：启用 Vue/Nuxt 开发工具"}]}]},{"ID":"20250510111017-g8vt9bd","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250510111017-g8vt9bd","updated":"20250510111017"},"Children":[{"ID":"20250510111017-oh9mmk4","Type":"NodeParagraph","Properties":{"id":"20250510111017-oh9mmk4","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"调试辅助 ：开启 sourcemap 等调试功能"}]}]},{"ID":"20250510111017-m2clc4n","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250510111017-m2clc4n","updated":"20250510111017"},"Children":[{"ID":"20250510111017-yf94v2p","Type":"NodeParagraph","Properties":{"id":"20250510111017-yf94v2p","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"开发优化 ：配置 HMR (热更新)、更快的构建等"}]}]},{"ID":"20250510111017-4eyewv7","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20250510111017-4eyewv7","updated":"20250510111017"},"Children":[{"ID":"20250510111017-muznteh","Type":"NodeParagraph","Properties":{"id":"20250510111017-muznteh","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"安全隔离 ：避免开发配置泄露到生产环境"}]}]}]},{"ID":"20250510111017-8ihuttg","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250510111017-8ihuttg","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"3. 完整最佳实践方案"}]},{"ID":"20250510111017-kqxybp6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111017-kqxybp6","updated":"20250510111017"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dHlwZXNjcmlwdA=="},{"Type":"NodeCodeBlockCode","Data":"export default defineNuxtConfig({\n  runtimeConfig: {\n    public: {\n      apiBaseUrl: process.env.NUXT_PUBLIC_API_BASE_URL\n    }\n  },\n  \n  $production: {\n    routeRules: {\n      '/**': { isr: 3600 } // 1小时缓存\n    },\n    nitro: {\n      compressPublicAssets: {\n        gzip: true,\n        brotli: true\n      }\n    }\n  },\n  \n  $development: {\n    devtools: { enabled: true },\n    vite: {\n      server: {\n        hmr: {\n          clientPort: 24678,\n          protocol: 'ws'\n        }\n      }\n    }\n  }\n})\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250510111017-3mcf94i","Type":"NodeParagraph","Properties":{"id":"20250510111017-3mcf94i","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"关键点："}]},{"ID":"20250510111017-toan7d6","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250510111017-toan7d6","updated":"20250510111017"},"Children":[{"ID":"20250510111017-vq7mczw","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250510111017-vq7mczw","updated":"20250510111017"},"Children":[{"ID":"20250510111017-pe405x8","Type":"NodeParagraph","Properties":{"id":"20250510111017-pe405x8","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"环境变量 ：使用 NUXT_PUBLIC_ 前缀的变量通过 runtimeConfig 暴露给客户端"}]}]},{"ID":"20250510111017-yx6n199","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250510111017-yx6n199","updated":"20250510111017"},"Children":[{"ID":"20250510111017-b8hhxa1","Type":"NodeParagraph","Properties":{"id":"20250510111017-b8hhxa1","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"条件配置 ：使用 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"development 和"},{"Type":"NodeText","Data":"production 隔离环境特定配置"}]}]},{"ID":"20250510111017-23nln12","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250510111017-23nln12","updated":"20250510111017"},"Children":[{"ID":"20250510111017-u1654cj","Type":"NodeParagraph","Properties":{"id":"20250510111017-u1654cj","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"安全 ：敏感配置不要放在 public 下"}]}]},{"ID":"20250510111017-p8xbt8e","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20250510111017-p8xbt8e","updated":"20250510111017"},"Children":[{"ID":"20250510111017-ulimwg1","Type":"NodeParagraph","Properties":{"id":"20250510111017-ulimwg1","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"默认值 ：在代码中设置合理的默认值"}]}]}]},{"ID":"20250510111017-af2j4uv","Type":"NodeParagraph","Properties":{"id":"20250510111017-af2j4uv","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"‍"}]},{"ID":"20250510111017-mchhbwb","Type":"NodeParagraph","Properties":{"id":"20250510111017-mchhbwb","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":"‍"}]},{"ID":"20250510111017-i4suzi3","Type":"NodeParagraph","Properties":{"id":"20250510111017-i4suzi3","updated":"20250510111017"},"Children":[{"Type":"NodeText","Data":".env.development       # 开发环境变量\n.env.production        # 生产环境变量\nnuxt.config.ts         # 主配置（含 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"development/"},{"Type":"NodeText","Data":"production）\napp.config.ts          # 静态应用配置"}]}]}