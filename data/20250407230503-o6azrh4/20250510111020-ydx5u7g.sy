{"ID":"20250510111020-ydx5u7g","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250510111020-ydx5u7g","title":"在 Nuxt 3 中，处理不同环境(开发生产)的 base URL 和配置的最佳实践如下：_conflict_github_1746846617563","type":"doc","updated":"20250510111020"},"Children":[{"ID":"20250510111016-1irhlyo","Type":"NodeThematicBreak","Properties":{"id":"20250510111016-1irhlyo","updated":"20250510111016"}},{"ID":"20250510111016-kwlc3ku","Type":"NodeParagraph","Properties":{"id":"20250510111016-kwlc3ku","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"title: 在 Nuxt 3 中，处理不同环境(开发生产)的 base URL 和配置的最佳实践如下：\ndate: 2025-04-07T23:05:04Z\nlastmod: 2025-04-07T23:20:00Z"}]},{"ID":"20250510111016-e0u9kgx","Type":"NodeThematicBreak","Properties":{"id":"20250510111016-e0u9kgx","updated":"20250510111016"}},{"ID":"20250510111016-sq632lq","Type":"NodeParagraph","Properties":{"id":"20250510111016-sq632lq","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"‍"}]},{"ID":"20250510111016-dq0zct2","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250510111016-dq0zct2","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"1. 环境变量与 runtimeConfig 最佳实践"}]},{"ID":"20250510111016-3lyyi3u","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111016-3lyyi3u","updated":"20250510111016"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dHlwZXNjcmlwdA=="},{"Type":"NodeCodeBlockCode","Data":"export default defineNuxtConfig({\n  runtimeConfig: {\n    // 仅在服务端可用的私有变量\n    apiSecret: '', // 会被.env中的NUXT_API_SECRET覆盖\n    \n    // 客户端也可用的公共变量\n    public: {\n      apiBaseUrl: process.env.NUXT_PUBLIC_API_BASE_URL || 'https://default-api.example.com'\n    }\n  }\n})\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250510111016-uuy1msd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111016-uuy1msd","updated":"20250510111016"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250510111016-fcv0bml","Type":"NodeParagraph","Properties":{"id":"20250510111016-fcv0bml","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"使用方式："}]},{"ID":"20250510111016-1b137on","Type":"NodeList","ListData":{},"Properties":{"id":"20250510111016-1b137on","updated":"20250510111016"},"Children":[{"ID":"20250510111016-476hqfd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250510111016-476hqfd","updated":"20250510111016"},"Children":[{"ID":"20250510111016-hnplghb","Type":"NodeParagraph","Properties":{"id":"20250510111016-hnplghb","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"创建 .env 文件："}]},{"ID":"20250510111016-cq62j50","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111016-cq62j50","updated":"20250510111016"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGxhaW50ZXh0"},{"Type":"NodeCodeBlockCode","Data":"# 开发环境\nNUXT_PUBLIC_API_BASE_URL=http://localhost:3000/api\n\n# 生产环境 (通常由CI/CD设置)\n# NUXT_PUBLIC_API_BASE_URL=https://api.example.com\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250510111016-klwwysm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250510111016-klwwysm","updated":"20250510111016"},"Children":[{"ID":"20250510111016-hg9nlo1","Type":"NodeParagraph","Properties":{"id":"20250510111016-hg9nlo1","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"在代码中使用："}]},{"ID":"20250510111016-61yxo6j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111016-61yxo6j","updated":"20250510111016"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dHlwZXNjcmlwdA=="},{"Type":"NodeCodeBlockCode","Data":"const runtimeConfig = useRuntimeConfig()\nconst baseUrl = runtimeConfig.public.apiBaseUrl\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250510111016-9txo97y","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250510111016-9txo97y","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"2. "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"development 和"},{"Type":"NodeText","Data":"production 的意义"}]},{"ID":"20250510111016-d74ql46","Type":"NodeParagraph","Properties":{"id":"20250510111016-d74ql46","updated":"20250510111016"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"development 和"},{"Type":"NodeText","Data":"production 是 Nuxt 3 的条件配置，允许你根据环境指定不同的配置："}]},{"ID":"20250510111016-bsq3pzn","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111016-bsq3pzn","updated":"20250510111016"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dHlwZXNjcmlwdA=="},{"Type":"NodeCodeBlockCode","Data":"export default defineNuxtConfig({\n  // 通用配置\n  \n  $production: {\n    // 仅在生产环境生效\n    routeRules: {\n      '/**': { isr: true } // 生产环境启用增量静态再生\n    },\n    nitro: {\n      compressPublicAssets: true // 生产环境启用压缩\n    }\n  },\n  \n  $development: {\n    // 仅在开发环境生效\n    devtools: { enabled: true }, // 开发工具\n    sourcemap: true, // 启用sourcemap\n    vite: {\n      server: {\n        hmr: true // 热模块替换\n      }\n    }\n  }\n})\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250510111016-ulqc4rr","Type":"NodeParagraph","Properties":{"id":"20250510111016-ulqc4rr","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"$development 存在的意义 ："}]},{"ID":"20250510111016-b8cpulf","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250510111016-b8cpulf","updated":"20250510111016"},"Children":[{"ID":"20250510111016-qwikth6","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250510111016-qwikth6","updated":"20250510111016"},"Children":[{"ID":"20250510111016-fhyxmnw","Type":"NodeParagraph","Properties":{"id":"20250510111016-fhyxmnw","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"开发工具 ：启用 Vue/Nuxt 开发工具"}]}]},{"ID":"20250510111016-iz552au","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250510111016-iz552au","updated":"20250510111016"},"Children":[{"ID":"20250510111016-6fc0p1d","Type":"NodeParagraph","Properties":{"id":"20250510111016-6fc0p1d","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"调试辅助 ：开启 sourcemap 等调试功能"}]}]},{"ID":"20250510111016-1s3m8lh","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250510111016-1s3m8lh","updated":"20250510111016"},"Children":[{"ID":"20250510111016-7pm48lq","Type":"NodeParagraph","Properties":{"id":"20250510111016-7pm48lq","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"开发优化 ：配置 HMR (热更新)、更快的构建等"}]}]},{"ID":"20250510111016-zknlpr0","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20250510111016-zknlpr0","updated":"20250510111016"},"Children":[{"ID":"20250510111016-cw4ymbd","Type":"NodeParagraph","Properties":{"id":"20250510111016-cw4ymbd","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"安全隔离 ：避免开发配置泄露到生产环境"}]}]}]},{"ID":"20250510111016-ltk7rhx","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250510111016-ltk7rhx","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"3. 完整最佳实践方案"}]},{"ID":"20250510111016-1o5pb8l","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250510111016-1o5pb8l","updated":"20250510111016"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dHlwZXNjcmlwdA=="},{"Type":"NodeCodeBlockCode","Data":"export default defineNuxtConfig({\n  runtimeConfig: {\n    public: {\n      apiBaseUrl: process.env.NUXT_PUBLIC_API_BASE_URL\n    }\n  },\n  \n  $production: {\n    routeRules: {\n      '/**': { isr: 3600 } // 1小时缓存\n    },\n    nitro: {\n      compressPublicAssets: {\n        gzip: true,\n        brotli: true\n      }\n    }\n  },\n  \n  $development: {\n    devtools: { enabled: true },\n    vite: {\n      server: {\n        hmr: {\n          clientPort: 24678,\n          protocol: 'ws'\n        }\n      }\n    }\n  }\n})\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250510111016-khsjgqj","Type":"NodeParagraph","Properties":{"id":"20250510111016-khsjgqj","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"关键点："}]},{"ID":"20250510111016-iqtke53","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250510111016-iqtke53","updated":"20250510111016"},"Children":[{"ID":"20250510111016-ry0kr3g","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250510111016-ry0kr3g","updated":"20250510111016"},"Children":[{"ID":"20250510111016-l2z7gp5","Type":"NodeParagraph","Properties":{"id":"20250510111016-l2z7gp5","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"环境变量 ：使用 NUXT_PUBLIC_ 前缀的变量通过 runtimeConfig 暴露给客户端"}]}]},{"ID":"20250510111016-5x59d6t","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250510111016-5x59d6t","updated":"20250510111016"},"Children":[{"ID":"20250510111016-xnt3vne","Type":"NodeParagraph","Properties":{"id":"20250510111016-xnt3vne","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"条件配置 ：使用 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"development 和"},{"Type":"NodeText","Data":"production 隔离环境特定配置"}]}]},{"ID":"20250510111016-qlku7sr","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250510111016-qlku7sr","updated":"20250510111016"},"Children":[{"ID":"20250510111016-5xlyumv","Type":"NodeParagraph","Properties":{"id":"20250510111016-5xlyumv","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"安全 ：敏感配置不要放在 public 下"}]}]},{"ID":"20250510111016-5p5p0fn","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20250510111016-5p5p0fn","updated":"20250510111016"},"Children":[{"ID":"20250510111016-drfqsf5","Type":"NodeParagraph","Properties":{"id":"20250510111016-drfqsf5","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"默认值 ：在代码中设置合理的默认值"}]}]}]},{"ID":"20250510111016-d7z9r9s","Type":"NodeParagraph","Properties":{"id":"20250510111016-d7z9r9s","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"‍"}]},{"ID":"20250510111016-viaykxn","Type":"NodeParagraph","Properties":{"id":"20250510111016-viaykxn","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":"‍"}]},{"ID":"20250510111016-8i5f8yf","Type":"NodeParagraph","Properties":{"id":"20250510111016-8i5f8yf","updated":"20250510111016"},"Children":[{"Type":"NodeText","Data":".env.development       # 开发环境变量"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":".env.production        # 生产环境变量"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"nuxt.config.ts         # 主配置（含 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"development/"},{"Type":"NodeText","Data":"production）"},{"Type":"NodeBr","Data":"br"},{"Type":"NodeText","Data":"app.config.ts          # 静态应用配置"}]}]}